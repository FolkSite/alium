Описание
========

Система Alium - набор скриптов, обслуживающий рутинные операции магазина Merchium.

Она предназначена для:
1. Отслеживания изменения цен и наличия товара
2. Обновления цен по заложенным бизнес-правилам
3. (Добавления товаров в Merchium)

Системные требования
====================

PHP 5.4+ (из-за trait)
php: shmop расширение, см. вывод php –m | grep shmop (или инициировать phpmorphy как PHPMORPHY_STORAGE_MEM)
MongoDB 2+
(MySQL 5.2+)

Составные части и терминология
==============================

Мерчиум (Merchium)

Алиум (Alium)

Алиэкспресс (Ali)

Для предотвращения путаницы следует использовать следующие термины:

`fetch` - импорт товаров Merchium->Alium

`pull` - экспорт товаров Alium->Merchium

`import` - импорт товаров Ali->Merchium

`update` - обновление каких-либо данных

Другими словами, импорт в БД Алиума товаров из Мерчиума это `fetch`, а назад - `pull`, чтобы не путать с импортом из Ali.

Установка и настройка
=====================

(Переименовать файл etc/config.dist.php в config.php и настроить)

Создать проект по примеру projects/example.json

`name` - имя проекта

`uri` - URI проекта

`mongo.db` - название БД проекта

`mongo.collection` - название коллекции проекта

`price.closure` - замыкание, рассчитывающее цену

`price.round` - округлять цену?

`price.sweet` - уменьшать цену на рубль (работает при округлении цены)?

Создать уникальный индекс по `id`:

        use dbname;
        db.collection.ensureIndex({id: 1}, {unique: true});


Порядок работы
==============

Заполнение БД Алиума
--------------------

Файл `1-fetch-alium.php`

Применяется к CSV-выгрузке Merchiumа. Обновляет данные Алиума и загружает недостающие товары.

Обновление БД Алиума
--------------------

Файл `2-update-alium.php`

Запускается и автоматически обновляет данные магазина из интернет-магазина (Алиэкспресс).


Обновление магазина Merchium
---------------------------

Файл `3-pull-merchium.php`

Экспорт в CSV необходимых данных
